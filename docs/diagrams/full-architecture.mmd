graph TB
    subgraph "å…§å®¹ç”Ÿç”¢å±¤ (æœ¬åœ°æ©Ÿå™¨/å°ˆç”¨ä¼ºæœå™¨)"
        A1[ç”Ÿç”¢æ©Ÿ - Storytelling<br/>storytelling-cli/run.sh]
        A2[ç”Ÿç”¢æ©Ÿ - Podcast<br/>gemini-2-podcast/]

        A1_1[Step 1: ç”Ÿæˆè…³æœ¬<br/>generate_script.py<br/>Gemini 2.5 Pro]
        A1_2[Step 2: ç”ŸæˆéŸ³é »<br/>generate_audio.py<br/>Gemini TTS]
        A1_3[Step 3: ç”Ÿæˆå­—å¹•<br/>generate_subtitles.py<br/>MFA è©ç´šå°é½Š]

        A1 --> A1_1 --> A1_2 --> A1_3

        OUTPUT[output/<br/>foundation/chapter0/<br/>podcast_script.txt<br/>podcast.wav/mp3<br/>subtitles.srt<br/>metadata.json]

        A1_3 --> OUTPUT
        A2 --> |import_gemini_dialogue.py| OUTPUT
    end

    subgraph "é›²ç«¯å„²å­˜å±¤"
        GCS[Google Cloud Storage<br/>gs://storytelling-output/output<br/><br/>ğŸ“¦ å®Œæ•´å­˜å„²æ‰€æœ‰å…§å®¹<br/>ğŸµ éŸ³è¨Š .mp3 æ•¸ç™¾ MB<br/>ğŸ“ å­—å¹• .srt<br/>ğŸ“„ è…³æœ¬ + metadata .json]
    end

    subgraph "API æœå‹™å±¤ (Render Deployment)"
        B[FastAPI Server<br/>GitHub: podcast-workspace<br/>rootDir: backend<br/><br/>ğŸ”¹ ä¸ç”Ÿæˆå…§å®¹<br/>ğŸ”¹ æƒæ GCS é ç¨‹æ•¸æ“š<br/>ğŸ”¹ å»ºç«‹æ›¸ç±/ç« ç¯€ç´¢å¼•<br/>ğŸ”¹ Starter Plan @ Singapore]

        B1[GCSMirror<br/>å†·å•Ÿå‹•åŒæ­¥ .json åˆ°æœ¬åœ°<br/>/tmp/storytelling-output<br/>ç¯€çœè¨˜æ†¶é«”èˆ‡å•Ÿå‹•æ™‚é–“]
        B2[OutputDataCache<br/>è§£æ metadata.json<br/>å»ºç«‹ API ç´¢å¼•]

        B --> B1 --> B2
    end

    subgraph "å‰ç«¯æ¶ˆè²»å±¤"
        C[iOS App<br/>audio-earning-ios<br/><br/>SwiftUI + MVVM + DependencyContainer]

        C1[ğŸ“š æ›¸åŸ/æ›¸åº«ç€è¦½<br/>6h å¿«å– TTL]
        C2[ğŸ§ æ’­æ”¾å™¨<br/>AVPlayer + æ³¢å½¢]
        C3[ğŸ“ å­—å¹•/ç¿»è­¯/è§£é‡‹<br/>è©ç´šé«˜äº®]
        C4[ğŸ’¾ æ‰¹æ¬¡ä¸‹è¼‰<br/>é›¢ç·šä½¿ç”¨]
        C5[ğŸ”§ ä¼ºæœå™¨è¨­å®š<br/>å¤šç«¯é» + GET /health]
        C6[ğŸ—‚ï¸ JSON å°å‡º/åŒ¯å…¥<br/>å‚™ä»½ + åŒ¯å…¥è¦†è“‹]
        C7[ğŸ—ï¸ æ–°èç‰†/æœå°‹<br/>NewsService + å¿«å–]

        C --> C1
        C --> C2
        C --> C3
        C --> C4
        C --> C5
        C --> C6
        C --> C7
    end

    OUTPUT -.->|sync_output.sh<br/>ä¸Šå‚³æ‰€æœ‰æ–‡ä»¶| GCS
    GCS -.->|å†·å•Ÿå‹•åŒæ­¥<br/>åƒ…ä¸‹è¼‰ .json metadata| B1

    B2 -->|Content + Settings API<br/>GET /health<br/>GET /books<br/>GET /books/{id}/chapters<br/>GET /chapters/{id} (æ’­æ”¾)| C
    B -->|Interactive API<br/>POST /translations<br/>POST /explain/{sentence,phrase}<br/>/news/headlines/search/events| C

    GCS -.->|gcs-public æ¨¡å¼<br/>HTTP 307 è½‰å€<br/>storage.googleapis.com| C

    style A1 fill:#e3f2fd
    style A2 fill:#e3f2fd
    style OUTPUT fill:#fff9c4
    style GCS fill:#f3e5f5
    style B fill:#fff3e0
    style C fill:#e8f5e9
